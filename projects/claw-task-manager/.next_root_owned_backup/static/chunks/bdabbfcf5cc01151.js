(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,18566,(e,t,a)=>{t.exports=e.r(76562)},51703,e=>{"use strict";e.i(36180);var t=e.i(98925),a=e.i(67426);function r(){return Date.now()}async function s(e){var s,i;let n=(0,a.firestoreDb)(),d=(0,t.doc)(n,"users",e.uid),o=await (0,t.getDoc)(d);if(!o.exists()){let a=(s=e.uid,`ws_${s}`),i=(0,t.doc)(n,"workspaces",a);return await (0,t.setDoc)(i,{id:a,name:`${e.displayName??"My"} Workspace`,createdAt:r(),updatedAt:r()}),await (0,t.setDoc)((0,t.doc)(n,"workspaces",a,"members",e.uid),{uid:e.uid,role:"owner",createdAt:r()}),await (0,t.setDoc)(d,{uid:e.uid,email:e.email??null,displayName:e.displayName??null,photoURL:e.photoURL??null,defaultWorkspaceId:a,createdAt:r(),updatedAt:r()}),{defaultWorkspaceId:a}}let c=o.data();if(!c.defaultWorkspaceId){let a=(i=e.uid,`ws_${i}`);return await (0,t.updateDoc)(d,{defaultWorkspaceId:a,updatedAt:r()}),{defaultWorkspaceId:a}}return{defaultWorkspaceId:c.defaultWorkspaceId}}async function i(e){let r=(0,a.firestoreDb)(),s=(0,t.query)((0,t.collection)(r,"workspaces",e,"instances"),(0,t.limit)(1));return!(await (0,t.getDocs)(s)).empty}e.s(["ensureUserAndWorkspace",()=>s,"workspaceHasInstance",()=>i])},52683,e=>{"use strict";var t=e.i(43476),a=e.i(71645),r=e.i(18566);e.i(51718);var s=e.i(18357),i=e.i(67426),n=e.i(51703);function d(){let e=(0,r.useRouter)(),[d,o]=(0,a.useState)("loading");return(0,a.useEffect)(()=>{let t=(0,s.onAuthStateChanged)((0,i.firebaseAuth)(),async t=>{if(!t){o("noauth"),e.replace("/sign-in");return}let{defaultWorkspaceId:a}=await (0,n.ensureUserAndWorkspace)(t);if(!await (0,n.workspaceHasInstance)(a)){o("needs-onboarding"),e.replace("/onboarding");return}o("ready"),e.replace("/boards")});return()=>t()},[e]),(0,t.jsx)("main",{className:"min-h-screen flex items-center justify-center p-6",children:(0,t.jsx)("div",{className:"panel p-4 text-[color:var(--muted)]",children:"loading"===d?"Loading…":"Redirecting…"})})}e.s(["default",()=>d])}]);