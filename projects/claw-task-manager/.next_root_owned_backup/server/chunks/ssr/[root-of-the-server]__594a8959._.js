module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},84617,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(8876);function d(a){let d=(0,c.firestoreDb)();return(0,b.collection)(d,"workspaces",a,"boards")}async function e(a){let c=(0,b.query)(d(a),(0,b.orderBy)("createdAt","desc"));return(await (0,b.getDocs)(c)).docs.map(a=>({id:a.id,...a.data()}))}async function f(a,c){return(await (0,b.addDoc)(d(a),{...c,createdAt:Date.now(),updatedAt:Date.now()})).id}async function g(a,d,e){let f=(0,c.firestoreDb)();await (0,b.updateDoc)((0,b.doc)(f,"workspaces",a,"boards",d),{...e,updatedAt:Date.now()})}a.s(["createBoard",()=>f,"listBoards",()=>e,"updateBoard",()=>g])},79826,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(8876);function d(){return Date.now()}async function e(a){var e,f;let g=(0,c.firestoreDb)(),h=(0,b.doc)(g,"users",a.uid),i=await (0,b.getDoc)(h);if(!i.exists()){let c=(e=a.uid,`ws_${e}`),f=(0,b.doc)(g,"workspaces",c);return await (0,b.setDoc)(f,{id:c,name:`${a.displayName??"My"} Workspace`,createdAt:d(),updatedAt:d()}),await (0,b.setDoc)((0,b.doc)(g,"workspaces",c,"members",a.uid),{uid:a.uid,role:"owner",createdAt:d()}),await (0,b.setDoc)(h,{uid:a.uid,email:a.email??null,displayName:a.displayName??null,photoURL:a.photoURL??null,defaultWorkspaceId:c,createdAt:d(),updatedAt:d()}),{defaultWorkspaceId:c}}let j=i.data();if(!j.defaultWorkspaceId){let c=(f=a.uid,`ws_${f}`);return await (0,b.updateDoc)(h,{defaultWorkspaceId:c,updatedAt:d()}),{defaultWorkspaceId:c}}return{defaultWorkspaceId:j.defaultWorkspaceId}}async function f(a){let d=(0,c.firestoreDb)(),e=(0,b.query)((0,b.collection)(d,"workspaces",a,"instances"),(0,b.limit)(1));return!(await (0,b.getDocs)(e)).empty}a.s(["ensureUserAndWorkspace",()=>e,"workspaceHasInstance",()=>f])},69583,a=>{"use strict";var b=a.i(72131);a.i(30485),a.i(31052),a.i(8876),a.i(79826);function c(){let[a,c]=(0,b.useState)(()=>"ws_e2e_user"),[d,e]=(0,b.useState)(()=>!0);return(0,b.useEffect)(()=>{},[]),{workspaceId:a,authReady:d}}a.s(["useWorkspace",()=>c])},46840,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(8876);async function d(a,d,e){let f;return(await (0,b.addDoc)((f=(0,c.firestoreDb)(),(0,b.collection)(f,"workspaces",a,"boards",d,"cards")),{...e,boardId:d,order:Date.now(),createdAt:Date.now(),updatedAt:Date.now()})).id}async function e(a,d,e,f){let g=(0,c.firestoreDb)();await (0,b.updateDoc)((0,b.doc)(g,"workspaces",a,"boards",d,"cards",e),{...f,updatedAt:Date.now()})}a.s(["createCard",()=>d,"updateCard",()=>e])},96283,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(97454),e=a.i(69583),f=a.i(84617),g=a.i(46840);a.i(8876);function h(){let{workspaceId:a,authReady:h}=(0,e.useWorkspace)(),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)([]),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!1);(0,c.useEffect)(()=>{if(!a)return;let b=!1;return(async()=>{let c=await (0,f.listBoards)(a);b||r(c.map(a=>({id:a.id,name:a.name})))})().catch(()=>{}),()=>{b=!0}},[a]);let u=(0,c.useMemo)(()=>!!i.trim()&&!!m&&!!a,[i,m,a]);async function v(){let b=i.trim();if(b){if(!m)return void alert("Select a board first.");if(!a)return void alert("Missing workspace.");p(!0);try{let a=await fetch("/api/intake/extract?e2e=1",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({text:b,boardId:m})});if(!a.ok){let b=await a.json().catch(()=>({}));throw Error(b?.error||`extract_failed_${a.status}`)}let c=await a.json();l((c.candidates||[]).map(a=>({text:a})))}catch(b){let a=b instanceof Error?b.message:String(b);alert(`Extract failed: ${a}`)}finally{p(!1)}}}async function w(){if(!m)return void alert("Select a board first.");if(!a)return void alert("Missing workspace.");if(k.length){t(!0);try{let b=i.slice(0,2e3);await Promise.all(k.map(c=>(0,g.createCard)(a,m,{title:c.text.length>80?c.text.slice(0,77)+"…":c.text,description:b,priority:"P2",source:"Manual",columnId:"proposed",order:Date.now(),artifacts:[],approval:{status:"NOT_REQUESTED"}}))),l([]),j(""),alert("Added tasks to Proposed.")}finally{t(!1)}}}return h?(0,b.jsxs)(d.NavShell,{title:"Intake",children:[(0,b.jsxs)("div",{className:"panel p-5",children:[(0,b.jsx)("div",{className:"text-sm text-[color:var(--muted)]",children:"Option A security: Intake text is processed by the app backend only (not sent to the bot) unless you explicitly add an “Ask bot” step later."}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-[color:var(--muted)] font-extrabold",children:"Target board"}),(0,b.jsxs)("select",{value:m,onChange:a=>n(a.target.value),className:"mt-1 w-full rounded-2xl bg-[rgba(11,12,15,.7)] border border-[color:var(--stroke)] p-3 outline-none",children:[(0,b.jsx)("option",{value:"",children:"Select a board…"}),q.map(a=>(0,b.jsx)("option",{value:a.id,children:a.name},a.id))]}),0===q.length?(0,b.jsx)("div",{className:"mt-2 text-xs text-[color:var(--muted)]",children:"Create a board first."}):null]}),(0,b.jsxs)("div",{className:"mt-4",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-[color:var(--muted)] font-extrabold",children:"Input"}),(0,b.jsx)("textarea",{value:i,onChange:a=>j(a.target.value),placeholder:"Paste an email thread or meeting transcript here…",className:"mt-1 w-full min-h-[220px] rounded-2xl bg-[rgba(11,12,15,.7)] border border-[color:var(--stroke)] p-4 outline-none"}),(0,b.jsxs)("div",{className:"mt-3 flex flex-wrap gap-2",children:[(0,b.jsx)("button",{onClick:()=>void v(),disabled:o||!u,className:"btn-primary px-4 py-2 rounded-xl font-extrabold disabled:opacity-50",children:o?"Extracting…":"Extract tasks"}),(0,b.jsx)("button",{onClick:()=>{j(""),l([])},className:"px-4 py-2 rounded-xl border border-[color:var(--stroke)] bg-[rgba(22,26,34,.55)] font-bold",children:"Clear"})]})]})]}),(0,b.jsxs)("div",{className:"mt-4 panel p-5",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-[color:var(--muted)] font-extrabold",children:"Suggested tasks"}),(0,b.jsx)("div",{className:"chip",children:k.length})]}),(0,b.jsx)("div",{className:"mt-3 grid gap-2",children:k.length?k.map((a,c)=>(0,b.jsxs)("div",{className:"card p-3",children:[(0,b.jsx)("div",{className:"font-extrabold",children:a.text}),(0,b.jsx)("div",{className:"mt-2 text-xs text-[color:var(--muted)]",children:"Priority: P2 • Source: Intake"})]},c)):(0,b.jsx)("div",{className:"text-[color:var(--muted)]",children:"Nothing yet. Paste text and click “Extract tasks”."})}),(0,b.jsx)("div",{className:"mt-3",children:(0,b.jsx)("button",{disabled:!k.length||s,onClick:()=>void w(),className:`px-4 py-2 rounded-xl font-extrabold ${k.length&&!s?"btn-primary":"border border-[color:var(--stroke)] bg-[rgba(22,26,34,.35)] text-[color:var(--muted)]"}`,children:s?"Adding…":"Add to Proposed"})})]})]}):(0,b.jsx)(d.NavShell,{title:"Intake",children:(0,b.jsx)("div",{className:"panel p-4 text-[color:var(--muted)]",children:"Loading…"})})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__594a8959._.js.map