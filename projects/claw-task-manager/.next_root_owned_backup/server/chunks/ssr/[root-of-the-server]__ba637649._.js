module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},79826,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(8876);function d(){return Date.now()}async function e(a){var e,f;let g=(0,c.firestoreDb)(),h=(0,b.doc)(g,"users",a.uid),i=await (0,b.getDoc)(h);if(!i.exists()){let c=(e=a.uid,`ws_${e}`),f=(0,b.doc)(g,"workspaces",c);return await (0,b.setDoc)(f,{id:c,name:`${a.displayName??"My"} Workspace`,createdAt:d(),updatedAt:d()}),await (0,b.setDoc)((0,b.doc)(g,"workspaces",c,"members",a.uid),{uid:a.uid,role:"owner",createdAt:d()}),await (0,b.setDoc)(h,{uid:a.uid,email:a.email??null,displayName:a.displayName??null,photoURL:a.photoURL??null,defaultWorkspaceId:c,createdAt:d(),updatedAt:d()}),{defaultWorkspaceId:c}}let j=i.data();if(!j.defaultWorkspaceId){let c=(f=a.uid,`ws_${f}`);return await (0,b.updateDoc)(h,{defaultWorkspaceId:c,updatedAt:d()}),{defaultWorkspaceId:c}}return{defaultWorkspaceId:j.defaultWorkspaceId}}async function f(a){let d=(0,c.firestoreDb)(),e=(0,b.query)((0,b.collection)(d,"workspaces",a,"instances"),(0,b.limit)(1));return!(await (0,b.getDocs)(e)).empty}a.s(["ensureUserAndWorkspace",()=>e,"workspaceHasInstance",()=>f])},40777,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944);a.i(30485);var e=a.i(31052),f=a.i(8876),g=a.i(79826);function h(){let a=(0,d.useRouter)(),[h,i]=(0,c.useState)("loading");return(0,c.useEffect)(()=>{let b=(0,e.onAuthStateChanged)((0,f.firebaseAuth)(),async b=>{if(!b){i("noauth"),a.replace("/sign-in");return}let{defaultWorkspaceId:c}=await (0,g.ensureUserAndWorkspace)(b);if(!await (0,g.workspaceHasInstance)(c)){i("needs-onboarding"),a.replace("/onboarding");return}i("ready"),a.replace("/boards")});return()=>b()},[a]),(0,b.jsx)("main",{className:"min-h-screen flex items-center justify-center p-6",children:(0,b.jsx)("div",{className:"panel p-4 text-[color:var(--muted)]",children:"loading"===h?"Loading…":"Redirecting…"})})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__ba637649._.js.map