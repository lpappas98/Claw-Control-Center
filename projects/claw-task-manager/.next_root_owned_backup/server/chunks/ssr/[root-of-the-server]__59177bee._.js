module.exports=[72131,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].React},9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},36313,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.HooksClientContext},18341,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.ServerInsertedHtml},18622,(a,b,c)=>{b.exports=a.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},42602,(a,b,c)=>{"use strict";b.exports=a.r(18622)},87924,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactJsxRuntime},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},24361,(a,b,c)=>{b.exports=a.x("util",()=>require("util"))},14747,(a,b,c)=>{b.exports=a.x("path",()=>require("path"))},79826,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(8876);function d(){return Date.now()}async function e(a){var e,f;let g=(0,c.firestoreDb)(),h=(0,b.doc)(g,"users",a.uid),i=await (0,b.getDoc)(h);if(!i.exists()){let c=(e=a.uid,`ws_${e}`),f=(0,b.doc)(g,"workspaces",c);return await (0,b.setDoc)(f,{id:c,name:`${a.displayName??"My"} Workspace`,createdAt:d(),updatedAt:d()}),await (0,b.setDoc)((0,b.doc)(g,"workspaces",c,"members",a.uid),{uid:a.uid,role:"owner",createdAt:d()}),await (0,b.setDoc)(h,{uid:a.uid,email:a.email??null,displayName:a.displayName??null,photoURL:a.photoURL??null,defaultWorkspaceId:c,createdAt:d(),updatedAt:d()}),{defaultWorkspaceId:c}}let j=i.data();if(!j.defaultWorkspaceId){let c=(f=a.uid,`ws_${f}`);return await (0,b.updateDoc)(h,{defaultWorkspaceId:c,updatedAt:d()}),{defaultWorkspaceId:c}}return{defaultWorkspaceId:j.defaultWorkspaceId}}async function f(a){let d=(0,c.firestoreDb)(),e=(0,b.query)((0,b.collection)(d,"workspaces",a,"instances"),(0,b.limit)(1));return!(await (0,b.getDocs)(e)).empty}a.s(["ensureUserAndWorkspace",()=>e,"workspaceHasInstance",()=>f])},69583,a=>{"use strict";var b=a.i(72131);a.i(30485),a.i(31052),a.i(8876),a.i(79826);function c(){let[a,c]=(0,b.useState)(()=>"ws_e2e_user"),[d,e]=(0,b.useState)(()=>!0);return(0,b.useEffect)(()=>{},[]),{workspaceId:a,authReady:d}}a.s(["useWorkspace",()=>c])},84617,a=>{"use strict";a.i(69387);var b=a.i(60574),c=a.i(8876);function d(a){let d=(0,c.firestoreDb)();return(0,b.collection)(d,"workspaces",a,"boards")}async function e(a){let c=(0,b.query)(d(a),(0,b.orderBy)("createdAt","desc"));return(await (0,b.getDocs)(c)).docs.map(a=>({id:a.id,...a.data()}))}async function f(a,c){return(await (0,b.addDoc)(d(a),{...c,createdAt:Date.now(),updatedAt:Date.now()})).id}async function g(a,d,e){let f=(0,c.firestoreDb)();await (0,b.updateDoc)((0,b.doc)(f,"workspaces",a,"boards",d),{...e,updatedAt:Date.now()})}a.s(["createBoard",()=>f,"listBoards",()=>e,"updateBoard",()=>g])},1619,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d({open:a,title:d,children:e,onClose:f}){return((0,c.useEffect)(()=>{function b(a){"Escape"===a.key&&f()}return a&&window.addEventListener("keydown",b),()=>window.removeEventListener("keydown",b)},[a,f]),a)?(0,b.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,b.jsx)("div",{className:"absolute inset-0 bg-black/60",onClick:f}),(0,b.jsx)("div",{className:"absolute inset-0 p-4 sm:p-6 flex items-end sm:items-center justify-center",children:(0,b.jsxs)("div",{className:"w-full max-w-lg panel p-5 rounded-2xl shadow-2xl",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsx)("div",{className:"text-lg font-extrabold",children:d}),(0,b.jsx)("button",{onClick:f,"aria-label":"Close",className:"w-9 h-9 grid place-items-center rounded-xl border border-[color:var(--stroke)] bg-[rgba(22,26,34,.55)] text-[color:var(--muted)] hover:text-white",children:(0,b.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,b.jsx)("path",{d:"M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"}),(0,b.jsx)("path",{d:"M18 6L6 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})]})})]}),(0,b.jsx)("div",{className:"mt-4",children:e})]})})]}):null}a.s(["Modal",()=>d])},34587,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(97454),f=a.i(1619),g=a.i(69583);a.i(69387);var h=a.i(60574),i=a.i(8876),j=a.i(84617);function k(){let a=(0,d.useParams)(),k=(0,d.useRouter)(),l=decodeURIComponent(a.boardId),{workspaceId:m}=(0,g.useWorkspace)(),[n,o]=(0,c.useState)(!1),[p,q]=(0,c.useState)(null),[r,s]=(0,c.useState)(""),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1);(0,c.useEffect)(()=>{var a;let b,c;if(!m)return;let d=(a=a=>{let b=a?{id:a.id,name:a.name,description:a.description}:null;q(b),o(!0),b&&!x&&(s(b.name),u(b.description??""))},b=(0,i.firestoreDb)(),c=(0,h.doc)(b,"workspaces",m,"boards",l),(0,h.onSnapshot)(c,b=>{if(!b.exists())return a(null);a({id:b.id,...b.data()})}));return()=>d()},[m,l,x]);let z=(0,c.useMemo)(()=>!!m&&!!p&&r.trim().length>0,[m,p,r]);if(!m)return(0,b.jsx)(e.NavShell,{title:"Board settings",children:(0,b.jsx)("div",{className:"panel p-4 text-[color:var(--muted)]",children:"Loading…"})});if(n&&!p)return(0,b.jsx)(e.NavShell,{title:"Board settings",children:(0,b.jsx)("div",{className:"panel p-4 text-[color:var(--muted)]",children:"Board not found."})});if(!p)return(0,b.jsx)(e.NavShell,{title:"Board settings",children:(0,b.jsx)("div",{className:"panel p-4 text-[color:var(--muted)]",children:"Loading…"})});async function A(){m&&p&&(await (0,j.updateBoard)(m,l,{name:r.trim()||p.name,description:t.trim()||void 0}),k.replace("/boards"))}return(0,b.jsxs)(e.NavShell,{title:"Board settings",children:[(0,b.jsxs)("div",{className:"panel p-5",children:[(0,b.jsx)("div",{className:"text-xs uppercase tracking-wide text-[color:var(--muted)] font-extrabold",children:"Name"}),(0,b.jsx)("input",{value:r,onChange:a=>{y(!0),s(a.target.value)},className:"mt-1 w-full rounded-2xl bg-[rgba(11,12,15,.7)] border border-[color:var(--stroke)] p-3 outline-none"}),(0,b.jsx)("div",{className:"mt-4 text-xs uppercase tracking-wide text-[color:var(--muted)] font-extrabold",children:"Description"}),(0,b.jsx)("textarea",{value:t,onChange:a=>{y(!0),u(a.target.value)},className:"mt-1 w-full min-h-[90px] rounded-2xl bg-[rgba(11,12,15,.7)] border border-[color:var(--stroke)] p-3 outline-none"}),(0,b.jsx)("div",{className:"mt-4 text-xs text-[color:var(--muted)]",children:"Board deletion is not implemented yet in Firestore mode (needs server/admin recursive delete of cards)."}),(0,b.jsxs)("div",{className:"mt-5 flex flex-wrap gap-2",children:[(0,b.jsx)("button",{onClick:A,disabled:!z,className:"btn-primary px-4 py-3 rounded-2xl font-extrabold disabled:opacity-50",children:"Save"}),(0,b.jsx)("button",{onClick:()=>w(!0),className:"px-4 py-3 rounded-2xl border border-[rgba(225,29,72,.45)] bg-[rgba(225,29,72,.10)] font-extrabold",children:"Delete board"})]})]}),(0,b.jsxs)(f.Modal,{open:v,title:"Delete board?",onClose:()=>w(!1),children:[(0,b.jsx)("div",{className:"text-sm text-[color:var(--muted)]",children:"Deletion is temporarily disabled until we add a safe server-side recursive delete (board + cards)."}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsx)("button",{onClick:()=>w(!1),className:"w-full px-4 py-3 rounded-2xl border border-[color:var(--stroke)] bg-[rgba(22,26,34,.55)] font-extrabold",children:"Close"})})]})]})}a.s(["default",()=>k],34587)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__59177bee._.js.map