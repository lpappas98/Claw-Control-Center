[
  {
    "id": "test-before-claiming-done",
    "title": "Test before claiming 'done' or 'fixed'",
    "description": "Never claim work is complete without actually testing it first",
    "enabled": true,
    "content": "Before saying something is \"done\", \"fixed\", \"complete\", or \"ready\":\n\n1. **RUN THE CODE** - Execute it, don't just read it\n2. **TEST THE FEATURE** - Actually use it, don't assume it works\n3. **CHECK FOR ERRORS** - Look at logs, console output, error messages\n4. **VERIFY COMPILATION** - Run TypeScript/build checks if applicable\n5. **SCREENSHOT/PROOF** - Capture evidence it actually works\n\nThis applies to:\n- Your own work\n- Sub-agent deliverables\n- Package installations\n- Bug fixes\n- New features\n\n**If you can't test it yourself:** Say \"Code is written but needs manual testing\" instead of claiming it's done.\n\n**Why:** Multiple incidents of claiming \"done\" when code wouldn't even compile or crashed immediately on launch. This erodes trust and wastes Logan's time.",
    "severity": "critical",
    "category": "Quality & Testing",
    "updatedAt": "2026-02-12T14:40:00.000Z"
  },
  {
    "id": "compress-images-before-viewing",
    "title": "Compress user-sent images to reduce token cost",
    "description": "Shrink all images from user by ~10x or compress heavily before viewing",
    "enabled": true,
    "content": "When the user sends an image:\n\n1. **Never view the full-resolution image directly**\n2. **Always compress/resize first** using ImageMagick or similar:\n   - Shrink to ~10% of original size (e.g., 1920x1080 â†’ 192x108)\n   - OR compress with heavy JPEG quality reduction (e.g., -quality 20)\n3. **Verify it's still readable** at the reduced size\n4. **Then analyze the compressed version**\n\nGoal: Reduce token cost from images by 10x or more while keeping them viewable.\n\nCommand example:\n```bash\nconvert input.jpg -resize 10% -quality 30 output-compressed.jpg\n```\n\nThis saves significant tokens when users send screenshots or photos.",
    "severity": "required",
    "category": "Cost & Efficiency",
    "updatedAt": "2026-02-12T19:59:00.000Z"
  },
  {
    "id": "no-placeholder-implementations",
    "title": "No placeholder/stub code - always implement fully",
    "description": "Never ship placeholder screens or 'not implemented' stubs unless explicitly requested",
    "enabled": true,
    "content": "NEVER create placeholder implementations or stub code unless the user explicitly asks for it.\n\nâŒ FORBIDDEN:\n- Screens that throw 'not implemented' errors\n- Methods that just throw errors saying 'install X package'\n- Empty functions with TODO comments\n- Fake/mock data in place of real functionality\n- 'Coming soon' placeholders\n- Half-implemented features\n\nâœ… REQUIRED:\n- Fully implement the discussed solution\n- If a feature needs Package X, INSTALL Package X and implement it\n- If something is too complex, break it into phases and implement Phase 1 completely\n- If you can't implement something, SAY SO upfront - don't ship a placeholder\n\n**This applies to:**\n- Your own code\n- Code written by sub-agents you spawn\n- Any deliverables marked as 'done' or 'complete'\n\n**When spawning sub-agents:**\n- Include this rule in their instructions\n- Verify their work doesn't contain placeholders\n- Don't accept 'done' until it's actually functional\n\n**If you need to ship incomplete work:**\n- Get explicit permission first\n- Document exactly what IS and ISN'T implemented\n- Make it crystal clear in the PR/commit message\n\nShipping placeholder code and calling it 'complete' breaks trust. Don't do it.",
    "severity": "critical",
    "category": "Quality & Testing",
    "updatedAt": "2026-02-12T19:59:30.000Z"
  },
  {
    "id": "session-initialization-minimal",
    "title": "Minimal Session Initialization - Load Only Essentials",
    "description": "Start sessions with minimal context to reduce token costs by 80%",
    "enabled": true,
    "content": "## SESSION INITIALIZATION RULE (Cost Optimization)\n\nOn every session start:\n\n### âœ… ALWAYS LOAD (Essential Context):\n1. SOUL.md - Your personality/behavior\n2. USER.md - Who you're helping\n3. IDENTITY.md - Your name, role, avatar\n4. HEARTBEAT.md - Current heartbeat instructions\n5. memory/YYYY-MM-DD.md (today's file only, if exists)\n\n### âŒ NEVER AUTO-LOAD:\n1. MEMORY.md - Only load via memory_search when needed\n2. Prior session history - Don't request it automatically\n3. Old memory files - Don't load yesterday/last week\n4. Previous tool outputs - Start fresh\n5. Large context files - Load on-demand only\n\n### ðŸ” ON-DEMAND LOADING:\nWhen user asks about prior context:\n1. Use memory_search() to find relevant snippets\n2. Use memory_get() to pull ONLY the needed lines\n3. Don't load entire MEMORY.md \"just in case\"\n\n### ðŸ“ END OF SESSION:\nUpdate memory/YYYY-MM-DD.md with:\n- What you worked on\n- Decisions made\n- Important context for tomorrow\n- Next steps\n\n### ðŸ’° COST IMPACT:\n- Before: 50KB context = 2-3M tokens/session = $0.40/session\n- After: 8KB context = Only what's needed = $0.05/session\n- Savings: 80% reduction in context overhead\n\n**This rule is ALREADY enforced by your system prompt.** This document just makes it explicit.",
    "severity": "required",
    "category": "Cost & Efficiency",
    "updatedAt": "2026-02-12T20:37:00.000Z"
  },
  {
    "id": "model-routing-haiku-first",
    "title": "Model Routing - Use Haiku by Default, Sonnet for Complex Tasks",
    "description": "Route tasks to appropriate models to reduce costs by 90%",
    "enabled": true,
    "content": "## MODEL SELECTION RULE (Cost Optimization)\n\n### ðŸŽ¯ DEFAULT: Always use Haiku\nFor 90% of tasks:\n- File operations (read/write/edit)\n- Running commands (exec)\n- Simple code generation\n- Routine monitoring\n- File searching\n- Basic analysis\n- Most tool calls\n\n### ðŸ§  SWITCH TO SONNET ONLY FOR:\n1. **Architecture decisions** - System design, major refactors\n2. **Production code review** - Security-critical changes\n3. **Security analysis** - Vulnerability assessment\n4. **Complex debugging** - Multi-file reasoning, tricky bugs\n5. **Strategic planning** - Multi-project coordination\n6. **Advanced reasoning** - When Haiku struggles\n\n### ðŸ¤” WHEN IN DOUBT:\n**Try Haiku first.** If it struggles or gives poor results, then escalate to Sonnet.\n\n### ðŸ’° COST IMPACT:\n- Haiku: $0.25/M input, $1.25/M output\n- Sonnet: $3/M input, $15/M output\n- **Sonnet is 12x more expensive than Haiku**\n\n### âš™ï¸ HOW TO SWITCH:\n```bash\n# Logan needs to update ~/.openclaw/openclaw.json:\n{\n  \"agents\": {\n    \"defaults\": {\n      \"model\": {\n        \"primary\": \"anthropic/claude-haiku-4-5\"\n      }\n    }\n  }\n}\n```\n\n**Currently:** You're using Sonnet as default (expensive!)\n**Target:** Switch to Haiku as default, use Sonnet selectively\n\n**Note:** This requires Logan to update the OpenClaw config and restart the gateway. You can't change it yourself.",
    "severity": "high",
    "category": "Cost & Efficiency",
    "updatedAt": "2026-02-12T20:37:00.000Z"
  },
  {
    "id": "heartbeat-local-llm",
    "title": "Heartbeat Uses Local LLM (Ollama) - Zero Cost",
    "description": "Heartbeat checks should use free local LLM, not paid API",
    "enabled": true,
    "content": "## HEARTBEAT OPTIMIZATION\n\n**Current:** Heartbeats use paid API (Sonnet or Haiku)\n**Target:** Route to free local Ollama LLM\n\n### Why This Matters:\n- Heartbeats run every hour (or more frequently)\n- 24 checks/day = 720 checks/month\n- At $0.00025/1K tokens Ã— ~500 tokens = $0.09/month\n- Small individually, but adds up\n\n### What Logan Needs to Do:\n\n1. **Install Ollama:**\n```bash\ncurl -fsSL https://ollama.ai/install.sh | sh\nollama pull llama3.2:3b\n```\n\n2. **Update ~/.openclaw/openclaw.json:**\n```json\n{\n  \"heartbeat\": {\n    \"every\": \"1h\",\n    \"model\": \"ollama/llama3.2:3b\",\n    \"session\": \"main\",\n    \"prompt\": \"Check: Any blockers, opportunities, or progress updates needed?\"\n  }\n}\n```\n\n3. **Restart OpenClaw:**\n```bash\nollama serve  # Keep running in background\nopenclaw gateway restart\n```\n\n### Result:\n- Heartbeats = $0/month (runs locally)\n- No API rate limit impact\n- Faster responses (local)\n\n**Note:** You can't implement this yourself - requires Logan to install Ollama and update config.",
    "severity": "medium",
    "category": "Cost & Efficiency",
    "updatedAt": "2026-02-12T20:38:00.000Z"
  },
  {
    "id": "rate-limits-budget-controls",
    "title": "Rate Limits & Budget Controls - Prevent Runaway Costs",
    "description": "Enforce pacing between API calls and respect daily/monthly budgets",
    "enabled": true,
    "content": "## RATE LIMITS & BUDGET CONTROLS\n\n### â±ï¸ MANDATORY PACING:\n1. **5 seconds minimum** between API calls\n2. **10 seconds minimum** between web searches\n3. **Max 5 searches per batch**, then 2-minute break\n4. **Batch similar work** - One request for 10 items, not 10 separate requests\n5. **If 429 error:** STOP immediately, wait 5 minutes, then retry\n\n### ðŸ’° BUDGET LIMITS:\n- **Daily Budget:** $5 (warn at 75% = $3.75)\n- **Monthly Budget:** $200 (warn at 75% = $150)\n\n### ðŸš¨ WHEN TO WARN USER:\n```\nâš ï¸ Token Usage Alert:\nDaily: $3.80 / $5.00 (76%)\nAction: Pausing non-essential tasks until tomorrow\n```\n\n### âŒ WHAT THIS PREVENTS:\n- Rapid-fire API loops burning $20 overnight\n- Search spirals (\"let me research 100 companies...\")\n- Accidental automation explosions\n- Surprise bills at end of month\n\n### âœ… GOOD PATTERNS:\n```python\n# GOOD: Batch work\nresults = search(\"10 competitors in fintech\")\n\n# BAD: 10 separate calls\nfor company in companies:\n    search(company)  # DON'T DO THIS\n```\n\n### ðŸ“Š COST IMPACT:\n- Before: Unlimited usage, surprise bills\n- After: Predictable spend, warnings before limits\n- Savings: Prevents 1-2 expensive accidents/month = $50-100 saved",
    "severity": "critical",
    "category": "Cost & Efficiency",
    "updatedAt": "2026-02-12T20:38:00.000Z"
  },
  {
    "id": "prompt-caching-awareness",
    "title": "Prompt Caching - 90% Discount on Reused Content",
    "description": "Understand what gets cached and optimize for cache hits",
    "enabled": true,
    "content": "## PROMPT CACHING (90% Token Discount)\n\n### How It Works:\n- First request: Full price ($0.003/1K tokens)\n- Cache write: 25% fee ($0.00075/1K tokens)\n- Subsequent requests (within 5 min): 90% off ($0.00003/1K tokens)\n\n### âœ… WHAT GETS CACHED (Good):\n- System prompts (stable)\n- SOUL.md (rarely changes)\n- USER.md (stable)\n- TOOLS.md (stable)\n- AGENTS.md (stable)\n- IDENTITY.md (stable)\n- Reference materials (docs, specs)\n- Tool documentation\n\n### âŒ WHAT DOESN'T GET CACHED (Changes too often):\n- MEMORY.md (frequently updated)\n- memory/YYYY-MM-DD.md (daily updates)\n- Recent user messages\n- Tool outputs\n- Session history\n\n### ðŸ’° COST IMPACT:\n**Example:** 5KB system prompt, 100 calls/week\n- Before caching: 100 Ã— $0.015 = $1.50/week\n- After caching: $0.015 + (99 Ã— $0.0015) = $0.165/week\n- **Savings: 89% = $1.34/week = $70/year**\n\n### ðŸ“Š WHAT YOU NEED TO KNOW:\n1. **Keep stable files stable** - Don't edit SOUL.md constantly\n2. **Cache hits require exact match** - Even tiny changes break cache\n3. **5-minute TTL** - Cache expires after 5 min of inactivity\n4. **Works best with Sonnet** - Haiku already cheap, less benefit\n\n### âš™ï¸ CONFIGURATION (Logan must do):\nUpdate ~/.openclaw/openclaw-config.json:\n```json\n{\n  \"agents\": {\n    \"defaults\": {\n      \"cache\": {\n        \"enabled\": true,\n        \"ttl\": \"5m\",\n        \"priority\": \"high\"\n      },\n      \"models\": {\n        \"anthropic/claude-sonnet-4-5\": {\n          \"cache\": true\n        },\n        \"anthropic/claude-haiku-4-5\": {\n          \"cache\": false\n        }\n      }\n    }\n  }\n}\n```\n\n**Note:** OpenClaw may auto-cache when available. This config just ensures it's optimized.",
    "severity": "medium",
    "category": "Cost & Efficiency",
    "updatedAt": "2026-02-12T20:38:00.000Z"
  },
  {
    "id": "cache-hit-strategy",
    "title": "Cache Hit Strategy - Maximize 90% Discount",
    "description": "Optimize for cache hits to maximize prompt caching benefits",
    "enabled": true,
    "content": "## CACHE HIT STRATEGY\n\n### ðŸŽ¯ MAXIMIZE CACHE HITS:\n\n1. **Batch requests within 5-minute windows**\n   - Cache expires after 5 min of inactivity\n   - Make multiple API calls in quick succession\n   - Reduces cache misses between requests\n\n2. **Keep system prompts stable**\n   - Don't update SOUL.md mid-session\n   - Changes invalidate cache\n   - Batch updates during maintenance windows\n\n3. **Organize context hierarchically**\n   - Core system prompt (highest priority, cached)\n   - Stable workspace files (cached)\n   - Dynamic daily notes (NOT cached)\n\n4. **Separate stable from dynamic**\n   - product-reference.md (stable, cached)\n   - project-notes.md (dynamic, uncached)\n   - Prevents cache invalidation from note updates\n\n### ðŸ“Š REAL-WORLD EXAMPLE:\n**50 outreach emails/week on Sonnet**\n\n**Without caching:**\n- System prompt: 5KB Ã— 50 = 250KB/week = $0.75\n- Email drafts: 50 Ã— 8KB = $1.20\n- Total: $1.95/week = $102/month\n\n**With caching:**\n- System prompt: 1 write + 49 cached = $0.016\n- Email drafts: ~50% cache hits = $0.60\n- Total: $0.62/week = $32/month\n- **Savings: $70/month**\n\n### âœ… BEST PRACTICES:\n1. Cache stable system prompts (SOUL.md, USER.md)\n2. Batch requests within 5-minute windows\n3. Keep reference docs in separate cached files\n4. Monitor cache hit rate (target: >80%)\n5. Update system prompts during maintenance, not live\n6. Document cache strategy for consistency\n\n### âŒ WHEN NOT TO CACHE:\n- Haiku tasks (too cheap, overhead > savings)\n- Frequent prompt changes (invalidation costs more)\n- Small requests (<1KB) (overhead eats discount)\n- Development/testing (too many iterations)\n\n### ðŸ” MONITORING:\nUse session_status to check cache metrics:\n- Cache hits: 45/50 (90%) â† Good!\n- Cache tokens used: 225KB\n- Cost savings: $0.22 this session",
    "severity": "medium",
    "category": "Cost & Efficiency",
    "updatedAt": "2026-02-12T20:39:00.000Z"
  }
]